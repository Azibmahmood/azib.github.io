!function(d){AstraPortfolio={_ref:null,_api_params:{},_breakpoint:768,_iconUploader:null,items:[],init:function(){this._shwoLoader(),this._showSiteOnLoad(),this._masonry(),this._resetPagedCount(),this._bind(),this._display()},_shwoLoader:function(){d("#astra-portfolio .spinner").length||d("#astra-portfolio").append(wp.template("astra-portfolio-spinner"))},_showSiteOnLoad:function(){if(AstraPortfolio._getParamFromURL("portfolio")){var f=AstraPortfolio._getParamFromURL("portfolio"),o={slug:f},t=astraPortfolio.apiEndpoint+"astra-portfolio?"+decodeURIComponent(d.param(o));d.ajax({url:t,cache:!1}).done(function(o,t,a){if("success"===t&&o.length&&o[0]){d.each(o,function(o,t){AstraPortfolio.items[t.id]=t});var r="id"in o[0]?o[0].id:"",e="portfolio-type"in o[0]?o[0]["portfolio-type"]:"",i="astra-site-url"in o[0]?o[0]["astra-site-url"]+"TB_iframe=true&width=600&height=550":"",s="title"in o[0]?o[0].title.rendered:"";switch(e){case"image":var l="lightbox-image-url"in o[0]?o[0]["lightbox-image-url"]:"";jQuery.magnificPopup.open({items:{src:l},type:"image"},0);break;case"video":var n="portfolio-video-url"in o[0]?o[0]["portfolio-video-url"]:"";jQuery.magnificPopup.open({items:{src:n},type:"iframe"},0);break;case"iframe":if(s&&i){var p={title:s,href:i,rel:!1,slug:f,post_id:r,portfolio_type:e};AstraPortfolio._showSingleSite(p)}}}})}},_showSingleSite:function(o){var t=o.title||"",a=o.href||"",r=o.rel||"",e=o.slug||"",i=o.post_id||"",s=o.portfolio_type||"";if(a){d("html").addClass("processing");var l=astraPortfolio.settings["preview-bar-loc"]||"bottom";tb_show(t,a,r);d("#TB_ajaxWindowTitle").text();if(void 0!==i&&void 0!==AstraPortfolio.items[i]){var n=AstraPortfolio.items[i]["astra-site-call-to-action"]||"";n&&d("#TB_ajaxWindowTitle").after('<div class="astra-call-to-action">'+n+"</div>"),setTimeout(function(){AstraPortfolio._setCallToAction()},100)}(astraPortfolio.settings["responsive-button"]||!1)&&d("#TB_closeAjaxWindow").prepend(wp.template("astra-portfolio-responsive-view")),d("#TB_iframeContent").wrap('<div id="TB_iframeContent-wrapper"></div>'),d("#TB_window").addClass(l).addClass("astra-slug-"+e).addClass("astra-site-id-"+i).addClass("astra-portfolio-type-"+s).addClass("desktop"),astraPortfolio.siteLoadingEnabled&&d("#TB_window").addClass("astra-portfolio-thickbox-loading").append('<div class="site-loading"><h3>'+astraPortfolio.siteLoadingTitle+"</h3><p>"+astraPortfolio.siteLoadingMessage+"</p></div>")}},_setCallToAction:function(){if(d(".astra-call-to-action").length)if(d(window).outerWidth()<=768){var o=d(".astra-call-to-action").outerHeight();d("#TB_iframeContent-wrapper").css("bottom",o+100),d("#TB_window #TB_title").css("height",o+100)}else d("#TB_iframeContent-wrapper").css("bottom",""),d("#TB_window #TB_title").css("height","")},_getParamFromURL:function(o,t){t||(t=window.location.href),o=o.replace(/[\[\]]/g,"\\$&");var a=new RegExp("[?&]"+o+"(=([^&#]*)|&|#|$)").exec(t);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null},_display:function(){if("no"===astraPortfolio.settings["show-other-categories"]&&"no"===astraPortfolio.settings["show-categories"]&&"yes"===astraPortfolio.settings["show-search"]&&AstraPortfolio._showSites(),d(".astra-portfolio-filters").length){if("yes"===astraPortfolio.settings["show-categories"]){var o="categories",t={slug:(a="astra-portfolio-categories")+AstraPortfolio._getCategoryParams(o),id:a+"-wrap",class:a,trigger:"astra-api-all-category-loaded",wrapper_class:"filter-links",show_all:AstraPortfolio._getCategoryAllSelectStatus()};AstraPortfolioAPI._api_request(t)}if("yes"===astraPortfolio.settings["show-other-categories"]){var a;o="other-categories",t={slug:(a="astra-portfolio-other-categories")+AstraPortfolio._getCategoryParams(o),id:a+"-wrap",class:a,trigger:"astra-api-category-loaded",wrapper_class:"filter-links",show_all:AstraPortfolio._getOtherCategoryAllSelectStatus()};AstraPortfolioAPI._api_request(t)}}else AstraPortfolio._showSites()},_bind:function(){d(window).on("resize",AstraPortfolio._resize),d(document).on("astra-portfolio-api-request-fail",AstraPortfolio._apiFailed),d(document).on("astra-api-post-loaded-on-scroll",AstraPortfolio._reinitGridScrolled),d(document).on("astra-api-post-loaded",AstraPortfolio._reinitGrid),d(document).on("astra-api-category-loaded",AstraPortfolio._addFilters),d(document).on("astra-api-all-category-loaded",AstraPortfolio._loadFirstGrid),d(document).on("click",".iframe:not(.open-in-new-tab) .site-preview",AstraPortfolio._previewOpen),d(document).on("click",".actions a",AstraPortfolio._previewResponsive),d("body").on("thickbox:removed",AstraPortfolio._previewClose),d("body").on("thickbox:iframe:loaded",AstraPortfolio._previewLoaded),d(document).on("keyup input",".astra-portfolio-search",AstraPortfolio._search),d(document).on("click",".filter-links a",AstraPortfolio._filterClick),"click"===astraPortfolio.settings["show-portfolio-on"]?d(document).on("click",".astra-portfolio-load-more-sites",AstraPortfolio._next_page):d(document).on("scroll",AstraPortfolio._scroll)},_previewLoaded:function(o){o.preventDefault(),d("#TB_window").removeClass("astra-portfolio-thickbox-loading")},_lightboxInit:function(){d(".site-single.image").magnificPopup({delegate:"a",type:"image",tLoading:"Loading image #%curr%...",mainClass:"astra-portfolio-lightbox mfp-img-mobile",gallery:{enabled:!0,navigateByImgClick:!0,preload:[0,1]},image:{verticalFit:!0,tError:'<a href="%url%">The image #%curr%</a> could not be loaded.',titleSrc:function(o){return o.el.attr("title")}},callbacks:{change:function(o){var t=d(o.el).parents(".site-single").attr("data-slug")||"";if(t){AstraPortfolio._clean_url_params("portfolio");var a={portfolio:t};if(!AstraPortfolio._getParamFromURL("portfolio")){var r=window.location.href+(-1===window.location.href.indexOf("?")?"?":"&")+decodeURIComponent(d.param(a));AstraPortfolio._changeURL(r)}}},open:function(){var o=d(this.currItem.el).parents(".site-single").attr("data-slug")||"";if(o){var t={portfolio:o};if(!AstraPortfolio._getParamFromURL("portfolio")){var a=window.location.href+(-1===window.location.href.indexOf("?")?"?":"&")+decodeURIComponent(d.param(t));AstraPortfolio._changeURL(a)}}},close:function(){AstraPortfolio._clean_url_params("portfolio")}}}),d(".site-single.video").magnificPopup({delegate:"a",disableOn:700,type:"iframe",mainClass:"astra-portfolio-popup mfp-fade",removalDelay:160,preloader:!1,fixedContentPos:!1,callbacks:{open:function(){var o=d(this.currItem.el).parents(".site-single").attr("data-slug")||"";if(o){var t={portfolio:o};if(!AstraPortfolio._getParamFromURL("portfolio")){var a=window.location.href+(-1===window.location.href.indexOf("?")?"?":"&")+decodeURIComponent(d.param(t));AstraPortfolio._changeURL(a)}}},close:function(){AstraPortfolio._clean_url_params("portfolio")}}})},_clean_url_params:function(o){var t=AstraPortfolio._getQueryStrings();delete t[o],delete t[""];var a=window.location.href,r=a.substr(0,a.indexOf("?"));if(d.isEmptyObject(t))var e=r+decodeURIComponent(d.param(t));else{var i=-1===r.indexOf("?")?"?":"&";e=r+i+decodeURIComponent(d.param(t))}AstraPortfolio._changeURL(e)},_previewResponsive:function(o){o.preventDefault();var t=d(this).find(".dashicons"),a=t.attr("data-view")||"";d("#TB_window").removeClass("desktop"),d("#TB_window").removeClass("tablet"),d("#TB_window").removeClass("mobile"),d("#TB_window").addClass(a),d(".actions .dashicons").removeClass("active"),t.addClass("active"),d("#TB_iframeContent").removeClass(),d("#TB_iframeContent").addClass(a)},_filterClick:function(o){o.preventDefault(),d(this).parents(".filter-links").find("a").removeClass("active"),d(this).addClass("active"),d(".astra-portfolio").addClass("hide-me"),d("body").removeClass("astra-portfolio-loaded-all-sites"),d("#astra-portfolio .spinner").length||d("#astra-portfolio").append(wp.template("astra-portfolio-spinner")),d("#astra-portfolio .astra-portfolio-load-more-sites").length&&d("#astra-portfolio .astra-portfolio-load-more-sites").remove(),d("#astra-portfolio .astra-portfolio-not-found").length&&d("#astra-portfolio .astra-portfolio-not-found").remove(),d("#astra-portfolio .no-more-demos").length&&d("#astra-portfolio .no-more-demos").remove(),d(".astra-portfolio-search").val(""),d("body").addClass("astra-portfolio-loading"),AstraPortfolio._showSites(),astraPortfolio.scrollToTop&&d(".filters-wrap").length&&d("html, body").animate({scrollTop:d(".filters-wrap").offset().top-100})},_resize:function(){AstraPortfolio._masonry(),AstraPortfolio._setCallToAction()},_previewClose:function(o){o.preventDefault(),d("html").removeClass("processing");var t=AstraPortfolio._getQueryStrings();delete t.portfolio;var a=window.location.href,r=a.substr(0,a.indexOf("?"));if(d.isEmptyObject(t))var e=r+decodeURIComponent(d.param(t));else{var i=-1===r.indexOf("?")?"?":"&";e=r+i+decodeURIComponent(d.param(t))}AstraPortfolio._changeURL(e)},_previewOpen:function(o){o.preventDefault();var t=d(this).data("title")||d(this).data("name")||null,a=d(this).data("href")||d(this).data("alt"),r=d(this).data("rel")||!1,e=d(this).parents(".site-single").attr("data-slug")||"";id=d(this).parents(".site-single").attr("data-id")||"",portfolio_type=d(this).parents(".site-single").attr("data-portfolio-type")||"";var i={title:t,href:a,rel:r,slug:e,post_id:id,portfolio_type:portfolio_type};AstraPortfolio._showSingleSite(i);var s={portfolio:e};if(!AstraPortfolio._getParamFromURL("portfolio")){var l=window.location.href+(-1===window.location.href.indexOf("?")?"?":"&")+decodeURIComponent(d.param(s));AstraPortfolio._changeURL(l)}},_getQueryStrings:function(o){return(o||document.location.search).replace(/(^\?)/,"").split("&").map(function(o){return this[(o=o.split("="))[0]]=o[1],this}.bind({}))[0]},_changeURL:function(o){History.pushState(null,null,o)},_lazyLoad:function(){d(".astra-portfolio img").Lazy({effect:"fadeIn",onFinishedAll:function(){AstraPortfolio._process_masonry()&&(d(".astra-portfolio").masonry("reloadItems"),d(".astra-portfolio").masonry("layout"))}})},_masonry:function(){AstraPortfolio._process_masonry()&&d(".astra-portfolio").masonry({horizontalOrder:!1,percentPosition:!1})},_process_masonry:function(){var o=d(window).outerWidth();return!!(astraPortfolio.settings["enable-masonry"]&&768<=o)},_apiAddParam_search:function(){var o=d(".astra-portfolio-search").val()||"";""!==o&&(AstraPortfolio._api_params.search=o)},_apiAddParam_per_page:function(){var o=3;astraPortfolio.settings&&astraPortfolio.settings["par-page"]&&(o=parseInt(astraPortfolio.settings["par-page"])),AstraPortfolio._api_params.per_page=o},_apiAddParam_astra_site_tags:function(){var o=""+d(".astra-portfolio-wrap").data("tags")||"";""!==o&&(-1<o.indexOf(",")&&(o=o.replace(/^,|,$/g,"")),AstraPortfolio._api_params["astra-portfolio-tags"]=o)},_apiAddParam_astra_site_category:function(){if(d(".filter-links.astra-portfolio-categories").length){var o=d(".filter-links.astra-portfolio-categories").find(".active").data("group")||"";if(""!==o&&"all"!==o)AstraPortfolio._api_params["astra-portfolio-categories"]=o;else{var t=d(".astra-portfolio-wrap").data("categories");""!==t&&(AstraPortfolio._api_params["astra-portfolio-categories"]=t)}}else{var a=""+d(".astra-portfolio-wrap").data("categories")||"";""!==a&&(-1<a.indexOf(",")&&(a=a.replace(/^,|,$/g,"")),AstraPortfolio._api_params["astra-portfolio-categories"]=a)}},_apiAddParam_astra_site_page_builder:function(){if(d(".filter-links.astra-portfolio-other-categories").length){var o=d(".filter-links.astra-portfolio-other-categories").find(".active").data("group")||"";""!==o&&"all"!==o&&(AstraPortfolio._api_params["astra-portfolio-other-categories"]=o)}else{var t=""+d(".astra-portfolio-wrap").data("other-categories")||"";""!==t&&(-1<t.indexOf(",")&&(t=t.replace(/^,|,$/g,"")),AstraPortfolio._api_params["astra-portfolio-other-categories"]=t)}},_apiAddParam_page:function(){var o=parseInt(d("body").attr("data-astra-demo-paged"))||1;AstraPortfolio._api_params.page=o},_showSites:function(o,t){void 0===o&&(o=!0),void 0===t&&(t="astra-api-post-loaded"),o&&AstraPortfolio._resetPagedCount(),AstraPortfolio._api_params={},AstraPortfolio._apiAddParam_search(),AstraPortfolio._apiAddParam_per_page(),AstraPortfolio._apiAddParam_astra_site_tags(),AstraPortfolio._apiAddParam_astra_site_category(),AstraPortfolio._apiAddParam_astra_site_page_builder(),AstraPortfolio._apiAddParam_page();var a={slug:"astra-portfolio"+astraPortfolio.ApiURLSep+decodeURIComponent(d.param(AstraPortfolio._api_params)),trigger:t};AstraPortfolioAPI._api_request(a)},_getCategoryParams:function(o){var t=""+d(".astra-portfolio-wrap").data(o)||"";return t?-1<t.indexOf(",")?"?per_page=100&include="+t.replace(/^,|,$/g,""):"?per_page=100&include="+t:"?per_page=100"},_getCategoryAllSelectStatus:function(){return"category-show-all"in astraPortfolio.settings&&"yes"===astraPortfolio.settings["category-show-all"]},_getOtherCategoryAllSelectStatus:function(){return"other-category-show-all"in astraPortfolio.settings&&"yes"===astraPortfolio.settings["other-category-show-all"]},_loadFirstGrid:function(o,t){AstraPortfolio._addFilters(o,t),setTimeout(function(){AstraPortfolio._showSites()},100)},_addFilters:function(o,t){if(o.preventDefault(),astraPortfolio.settings.categories||setTimeout(function(){AstraPortfolio._showSites()},100),d("."+t.args.id).length){var a=wp.template("astra-portfolio-filters");d("."+t.args.id).html(a(t)).find("li:first a").addClass("active")}},_reinitGridScrolled:function(o,t){var a=wp.template("astra-portfolio-list");0<t.items_count?d("body").addClass("astra-portfolio-has-items").removeClass("astra-portfolio-not-has-items"):d("body").removeClass("astra-portfolio-has-items").addClass("astra-portfolio-not-has-items"),d(".astra-portfolio").removeClass("hide-me"),0<t.items.length?(d.each(t.items,function(o,t){AstraPortfolio.items[t.id]=t}),d(".filter-count .count").text(t.items_count),setTimeout(function(){d(".astra-portfolio").append(a(t)),"default"===astraPortfolio.settings["grid-style"]?(AstraPortfolio._lazyLoad(),AstraPortfolio._imagesLoaded()):AstraPortfolio.processed()},800)):(d("#astra-portfolio .spinner").length&&d("#astra-portfolio .spinner").remove(),d("#astra-portfolio .no-more-demos").length||d("#astra-portfolio").append(wp.template("astra-portfolio-no-more-demos")),d("#astra-portfolio .astra-portfolio-not-found").length&&d("#astra-portfolio .astra-portfolio-not-found").remove())},_reinitGrid:function(o,t){if(0<t.items_count?d("body").addClass("astra-portfolio-has-items").removeClass("astra-portfolio-not-has-items"):d("body").removeClass("astra-portfolio-has-items").addClass("astra-portfolio-not-has-items"),d(".astra-portfolio").removeClass("hide-me"),0<t.items.length){d.each(t.items,function(o,t){AstraPortfolio.items[t.id]=t});var a=wp.template("astra-portfolio-list");d(".filter-count .count").text(t.items_count),d("body").attr("data-astra-demo-last-request",t.items_count),d(".astra-portfolio").html(a(t)),"default"===astraPortfolio.settings["grid-style"]?(AstraPortfolio._lazyLoad(),AstraPortfolio._imagesLoaded()):AstraPortfolio.processed()}else d("#astra-portfolio .spinner").length&&d("#astra-portfolio .spinner").remove(),d(".astra-portfolio-grid").html(wp.template("astra-portfolio-not-found"))},_imagesLoaded:function(){d(".astra-portfolio-grid").imagesLoaded().always(function(o){AstraPortfolio.processed()}).progress(function(o,t){t.isLoaded})},processed:function(){d(".astra-portfolio").removeClass("hide-me"),AstraPortfolio._process_masonry()&&(d(".astra-portfolio").masonry("reloadItems"),d(".astra-portfolio").masonry("layout")),d("#astra-portfolio .spinner").length&&d("#astra-portfolio .spinner").remove(),AstraPortfolio._lightboxInit(),"click"!==astraPortfolio.settings["show-portfolio-on"]||d("#astra-portfolio .astra-portfolio-load-more-sites").length||d("#astra-portfolio").append(wp.template("astra-portfolio-load-more-sites")),d("body").removeClass("astra-portfolio-loading")},_apiFailed:function(o,t,a,r){a.status;d("#astra-portfolio .spinner").length&&d("#astra-portfolio .spinner").remove(),d(".astra-portfolio .site-single").length?d("#astra-portfolio .no-more-demos").length||d("#astra-portfolio").append(wp.template("astra-portfolio-no-more-demos")):d("#astra-portfolio .astra-portfolio-not-found").length||d("#astra-portfolio").append(wp.template("astra-portfolio-not-found")),d("body").addClass("astra-portfolio-loaded-all-sites")},_search:function(){$this=d(".astra-portfolio-search").val(),d(".filter-links.astra-portfolio-categories a").removeClass("active"),d("body").removeClass("astra-portfolio-loaded-all-sites"),d(".astra-portfolio").addClass("hide-me"),d("#astra-portfolio .spinner").length||d("#astra-portfolio").append(wp.template("astra-portfolio-spinner")),d("#astra-portfolio .astra-portfolio-load-more-sites").length&&d("#astra-portfolio .astra-portfolio-load-more-sites").remove(),d("#astra-portfolio .astra-portfolio-not-found").length&&d("#astra-portfolio .astra-portfolio-not-found").remove(),d("#astra-portfolio .no-more-demos").length&&d("#astra-portfolio .no-more-demos").remove(),d("body").addClass("astra-portfolio-loading"),window.clearTimeout(AstraPortfolio._ref),AstraPortfolio._ref=window.setTimeout(function(){AstraPortfolio._ref=null,d("body").addClass("astra-portfolio-loading"),d("body").attr("data-astra-demo-search",$this),AstraPortfolio._showSites()},500)},_next_page:function(o){AstraPortfolio._updatedPagedCount(),d("body").removeClass("astra-portfolio-loaded-all-sites"),d("body").addClass("astra-portfolio-loading"),d("#astra-portfolio .spinner").length||d("#astra-portfolio").append(wp.template("astra-portfolio-spinner")),d("#astra-portfolio .astra-portfolio-load-more-sites").length&&d("#astra-portfolio .astra-portfolio-load-more-sites").remove(),d("#astra-portfolio .astra-portfolio-not-found").length&&d("#astra-portfolio .astra-portfolio-not-found").remove(),d("#astra-portfolio .no-more-demos").length&&d("#astra-portfolio .no-more-demos").remove(),AstraPortfolio._showSites(!1,"astra-api-post-loaded-on-scroll")},_scroll:function(o){if(d(".astra-portfolio").length){var t=d(window).scrollTop(),a=Math.abs(d(window).height()-d(".astra-portfolio").offset().top-d(".astra-portfolio").height());ajaxLoading=d("body").data("scrolling"),a<t&&0==ajaxLoading&&!d("body").hasClass("astra-portfolio-loaded-all-sites")&&(AstraPortfolio._updatedPagedCount(),d("#astra-portfolio .spinner").length||d("#astra-portfolio").append(wp.template("astra-portfolio-spinner")),d("#astra-portfolio .astra-portfolio-load-more-sites").length&&d("#astra-portfolio .astra-portfolio-load-more-sites").remove(),d("#astra-portfolio .astra-portfolio-not-found").length&&d("#astra-portfolio .astra-portfolio-not-found").remove(),d("#astra-portfolio .no-more-demos").length&&d("#astra-portfolio .no-more-demos").remove(),d("body").data("scrolling",!0),AstraPortfolio._showSites(!1,"astra-api-post-loaded-on-scroll"))}},_updatedPagedCount:function(){paged=parseInt(d("body").attr("data-astra-demo-paged")),d("body").attr("data-astra-demo-paged",paged+1),window.setTimeout(function(){d("body").data("scrolling",!1)},800)},_resetPagedCount:function(){d("body").attr("data-astra-demo-last-request","1"),d("body").attr("data-astra-demo-paged","1"),d("body").attr("data-astra-demo-search",""),d("body").attr("data-scrolling",!1),d("body").removeClass("astra-portfolio-loading")}},d(function(){AstraPortfolio.init()})}(jQuery);